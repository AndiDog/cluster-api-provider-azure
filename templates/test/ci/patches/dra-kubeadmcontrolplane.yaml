- op: add
  path: /spec/kubeadmConfigSpec/files/-
  value:
    content: |
      version = 2
      [plugins]
        [plugins."io.containerd.grpc.v1.cri"]
          enable_cdi = true
    owner: root:root
    path: /etc/containerd/conf.d/device-plugin.toml
    permissions: "0644"
- op: add
  path: /spec/kubeadmConfigSpec/clusterConfiguration/apiServer/extraArgs/feature-gates
  value: ${K8S_FEATURE_GATES:-"DynamicResourceAllocation=true"}
- op: add
  path: /spec/kubeadmConfigSpec/clusterConfiguration/controllerManager/extraArgs/feature-gates
  value: HPAContainerMetrics=true,DynamicResourceAllocation=true
- op: add
  path: /spec/kubeadmConfigSpec/clusterConfiguration/apiServer/extraArgs/runtime-config
  value: resource.k8s.io/v1alpha3=true
- op: add
  path: /spec/kubeadmConfigSpec/clusterConfiguration/scheduler
  value:
    extraArgs:
      feature-gates: DynamicResourceAllocation=true
- op: add
  path: /spec/kubeadmConfigSpec/initConfiguration/nodeRegistration/kubeletExtraArgs/feature-gates
  value: DynamicResourceAllocation=true
- op: add
  path: /spec/kubeadmConfigSpec/joinConfiguration/nodeRegistration/kubeletExtraArgs/feature-gates
  value: DynamicResourceAllocation=true
